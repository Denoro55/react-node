(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{113:function(e,t){},117:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},128:function(e,t,a){},129:function(e,t,a){},130:function(e,t,a){},131:function(e,t,a){},133:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(34),c=a.n(r),s=a(2),i=a(9),l=a(4),u=a(13),m=a(16),d=a(17),f=a(18),p=a(20),v=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){console.log(this.props)}},{key:"render",value:function(){return o.a.createElement("div",null,"cart")}}]),a}(o.a.Component),E=function(e){return{type:"USER_DATA_UPDATE",payload:e}},g=function(e){return{type:"USER_COUNTERS_UPDATE",payload:e}},h=function(e,t){return function(){return function(a){return a({type:"GET_USER"}),e.getUserData().then((function(e){var n=e.body.data,o=Object(l.a)({auth:!0,token:t},n);return a({type:"GET_USER_SUCCESS",payload:o})})).catch((function(e){a({type:"GET_USER_FAILURE"})}))}}},_=(a(84),a(68)),b=a.n(_)()("http://localhost:".concat("5000")),N=Object(s.b)((function(e){return{isAuthenticated:e.user.auth,user:e.user}}),(function(e){return{actionUnauthorize:function(){return e((localStorage.removeItem("userData"),{type:"USER_UNAUTHORIZE"}))}}}))((function(e){var t=e.isAuthenticated,a=e.actionUnauthorize,n=e.user,r=function(e){e.preventDefault(),b.emit("leaveRoom",{id:n.id}),a()};return o.a.createElement("header",{className:"header"},o.a.createElement("nav",null,o.a.createElement("div",{className:"nav-wrapper"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col s12"},o.a.createElement(i.b,{className:"navbar-brand left",to:"/"},"Art's Store"),o.a.createElement("ul",{id:"nav-mobile",className:"left hide-on-med-and-down"},[{exact:!0,to:"/",name:"Home",isAuth:!1},{exact:!0,to:"/me",name:"Me",isAuth:!0},{exact:!0,to:"/followers",name:"Followers",isAuth:!0},{exact:!0,to:"/following",name:"Following",isAuth:!0},{exact:!1,to:"/messages/",name:"Messages",isAuth:!0},{exact:!0,to:"/search",name:"Search",isAuth:!0}].map((function(e,a){return!t&&e.isAuth||t&&!e.isAuth?null:o.a.createElement("li",{key:a,className:"nav-item"},o.a.createElement(i.c,{activeClassName:"active",className:"nav-link",exact:e.exact,to:e.to},e.name))}))),t?o.a.createElement("ul",{className:"navbar-nav ml-3 right"},o.a.createElement("li",{className:"nav-item"},o.a.createElement(i.c,{onClick:r,activeClassName:"active",className:"nav-link ml-auto",to:"/logout"},"Logout"))):o.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},o.a.createElement("li",{className:"nav-item"},o.a.createElement(i.c,{activeClassName:"active",className:"nav-link ml-auto",to:"/login"},"Login")),o.a.createElement("li",{className:"nav-item"},o.a.createElement(i.c,{activeClassName:"active",className:"nav-link ml-2",to:"/register"},"Sign up")))))))))})),C=Object(s.b)((function(e){return{user:e.user}}))((function(e){var t=e.user,a=t.auth?o.a.createElement("p",null,"Hello, ",o.a.createElement("b",null,t.name)):o.a.createElement("p",null,"Hello, Guest!");return o.a.createElement("div",{className:"container"},o.a.createElement("h4",{className:"mb-3"},"Home page"),a)})),O=a(7),y=Object(s.b)()((function(e){var t=e.dispatch,a=Object(n.useState)(1),r=Object(O.a)(a,2),c=r[0],i=r[1],l=Object(s.c)((function(e){return e.counter})),u=Object(n.useState)(l),m=Object(O.a)(u,2),d=m[0],f=m[1];Object(n.useEffect)((function(){setInterval((function(){console.log(c,l,d),p()}),3e3)}),[]),Object(n.useEffect)((function(){f(l)}),[l]);var p=function(){console.log(d),t({type:"COUNTER_ADD"})};return o.a.createElement("div",{className:"container"},o.a.createElement("h3",null,"Store page"),o.a.createElement("div",null,o.a.createElement("span",null,"Redux counter: ",l," ",d)),c,o.a.createElement("button",{onClick:function(){return i(c+1)}},"click"),o.a.createElement("button",{onClick:function(){return t({type:"COUNTER_ADD"})}},"redux click"))})),S=a(74),j=Object(s.b)((function(e){return{auth:e.user.auth}}))((function(e){var t=e.component,a=e.auth,n=Object(S.a)(e,["component","auth"]);return o.a.createElement(p.b,null,a?o.a.createElement(t,n):o.a.createElement(p.a,{to:"/login"}))})),k=a(14),w=o.a.createContext(),U=w.Provider,T=w.Consumer,I=function(e){return function(t){return o.a.createElement(T,null,(function(a){return o.a.createElement(e,Object.assign({},t,{apiService:a}))}))}},A=function(e){return function(t){var a=Object(s.c)((function(e){return e.user})),n=t.computedMatch.params.id;return n&&a.id.toString()===n.toString()?o.a.createElement(p.a,{to:"/me"}):o.a.createElement(e,t)}},P=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={form:{email:"",password:""},message:{color:"red",text:""}},e.login=function(t){t.preventDefault();var a=e.props,n=a.apiService,o=a.actionAuthorize,r=a.actionGetUserData;n.login(e.state.form).then((function(t){var a=t.body;if(a.errors)e.setState({message:{color:"red",text:a.message}});else{var n=a.token;n&&(o({auth:!0,token:n}),r(n).then((function(t){b.emit("connected",{id:t.payload.id}),e.props.history.push("/me")})))}})).catch((function(e){}))},e.onInputChange=function(t){e.setState({form:Object(l.a)({},e.state.form,Object(k.a)({},t.target.name,t.target.value))})},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.state.message,t=e.text?o.a.createElement("div",{className:"form-feedback"},e.text):null;return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"signup"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col s4 offset-s4 center"},o.a.createElement("form",{className:"form",onSubmit:this.login},o.a.createElement("div",{className:"form__title"},"Login"),o.a.createElement("div",{className:"form__body"},o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{type:"text",onChange:this.onInputChange,name:"email",className:"form-control",placeholder:"Email"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{type:"password",onChange:this.onInputChange,name:"password",className:"form-control",placeholder:"Password"}))),t,o.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Sign in"))))))}}]),a}(o.a.Component),R=I(Object(s.b)((function(e){return{token:e.user.token}}),(function(e,t){var a=t.apiService;t.token;return{actionGetUserData:function(t){return e(h(a,t)())},actionAuthorize:function(t){return e(function(e){var t=e.auth,a=e.token;return localStorage.setItem("userData",a),{type:"USER_AUTHORIZE",payload:{auth:t,token:a}}}(t))}}}))(P)),D=a(21),x=a.n(D),F=(a(117),function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={form:{name:"",email:"",password:""},message:{ok:!1,text:""}},e.register=function(t){t.preventDefault(),e.props.apiService.register(e.state.form).then((function(t){var a=t.body;a.errors?e.setState({message:{ok:!1,text:a.message}}):e.setState({message:{ok:!0,text:a.message},form:{name:"",email:"",password:""}})})).catch((function(e){}))},e.onInputChange=function(t){e.setState({form:Object(l.a)({},e.state.form,Object(k.a)({},t.target.name,t.target.value))})},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.state.message,t=x()({"form-feedback":!0,good:this.state.message.ok}),a=e.text?o.a.createElement("div",{className:t},e.text):null;return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"signup"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col s4 offset-s4 center"},o.a.createElement("form",{className:"form",onSubmit:this.register},o.a.createElement("div",{className:"form__title"},"Sign up"),o.a.createElement("div",{className:"form__body"},o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{type:"text",onChange:this.onInputChange,name:"name",className:"form-control",placeholder:"Name",value:this.state.form.name})),o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{type:"text",onChange:this.onInputChange,name:"email",className:"form-control",placeholder:"Email",value:this.state.form.email})),o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{type:"password",onChange:this.onInputChange,name:"password",className:"form-control",placeholder:"Password",value:this.state.form.password}))),a,o.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Sign up"))))))}}]),a}(o.a.Component)),L=I(Object(s.b)((function(e){return{}}),(function(e){return{checkAuth:function(){}}}))(F)),M=a(70),H=a.n(M),q=o.a.createContext(),G=Object(p.g)((function(e){var t=e.messagesList,a=e.openChat,r=Object(n.useContext)(q).publicPath;return o.a.createElement("ul",{className:"collection with-header"},t.map((function(e,t){return o.a.createElement("li",{key:t,className:"collection-item"},o.a.createElement("div",{className:"message-item"},o.a.createElement("div",{className:"message-item__content"},o.a.createElement("div",{className:"message-item__avatar"},o.a.createElement("div",{style:{backgroundImage:"url(".concat(r).concat(e.avatarUrl,")")},className:"message-item__avatar-icon"})),o.a.createElement("div",{className:"message-item__info"},o.a.createElement("div",{className:"message-item__name"},o.a.createElement("strong",null,e.name)),o.a.createElement("div",{className:"message-item__text"},e.text))),o.a.createElement("div",{className:"message-item__actions"},e.updated?o.a.createElement("div",{className:"message-item__action"},o.a.createElement("button",{onClick:function(){return a(e.id)},className:"btn btn-outline btn-danger btn-sm"},o.a.createElement("i",{className:"fa fa-envelope-open"}))):null,o.a.createElement("div",{className:"message-item__action"},o.a.createElement("button",{onClick:function(){return a(e.id)},className:"btn btn-outline btn-success btn-sm"},o.a.createElement("i",{className:"fa fa-weixin"}))))))})))})),z=function(){return o.a.createElement("div",{className:"preloader-wrapper big active"},o.a.createElement("div",{className:"spinner-layer spinner-blue-only"},o.a.createElement("div",{className:"circle-clipper left"},o.a.createElement("div",{className:"circle"})),o.a.createElement("div",{className:"gap-patch"},o.a.createElement("div",{className:"circle"})),o.a.createElement("div",{className:"circle-clipper right"},o.a.createElement("div",{className:"circle"}))))},J=a(8),W=function(e){return function(t){return function(a){var n;a({type:"FETCH_MESSAGES",payload:n}),e.getListMessages(t).then((function(e){a(function(e){return{type:"FETCH_MESSAGES_SUCCESS",payload:e}}(e.body.messages))})).catch((function(e){a({type:"FETCH_MESSAGES_FAILURE"})}))}}},B=function(e){return{type:"MESSAGE_UPDATE",payload:e}},K=function(e){return{type:"MESSAGES_LIST_UPDATE",payload:e}},V=function(e){return{type:"MESSAGES_LIST_SORT",payload:e.id}},X=function(e){return function(t,a){return function(n){return n({type:"FETCH_CHAT"}),e.getChatMessages(t,a).then((function(e){n({type:"FETCH_CHAT_SUCCESS",payload:e.body}),n(B({id:a,updated:!1,sort:!1}))})).catch((function(e){n({type:"FETCH_CHAT_FAILURE"})}))}}},Z=function(e){return{type:"CHAT_STATUS_UPDATE",payload:{inChat:e.inChat,chatId:e.chatId}}},$=function(e){return{type:"CHAT_MESSAGE_ADD",payload:{name:e.name,text:e.text}}},Q=function(e){return function(t,a,n,o){return function(r){var c=t.id;return e.sendMessage(c,a.id,n,t,o)}}},Y=I(Object(s.b)((function(e){return{user:e.user}}),(function(e,t){var a=t.apiService;return Object(J.b)({fetchChat:X(a),actionUpdateChatStatus:Z,addChatMessage:$,actionSendMessage:Q(a)},e)}))((function(e){var t=e.backToMessages,a=e.chatLoading,r=e.user,c=e.companionId,i=e.fetchChat,l=e.actionUpdateChatStatus,u=e.actionSendMessage,m=Object(n.useState)(""),d=Object(O.a)(m,2),f=d[0],p=d[1],v=Object(s.c)((function(e){return e.chat.messages})),E=Object(s.c)((function(e){return e.chat.companion})),g=Object(n.useRef)(null);Object(n.useEffect)((function(){return l({inChat:!0,chatId:c}),i(r.id,c),function(){l({inChat:!1,chatId:null})}}),[]),Object(n.useEffect)((function(){g.current&&(g.current.scrollTop=g.current.scrollHeight)}),[v]);return o.a.createElement("div",{className:"chat"},o.a.createElement("div",{className:"chat__back"},o.a.createElement("button",{onClick:t,className:"btn btn-primary"},"Back")),o.a.createElement("div",{className:"chat__block"},o.a.createElement("div",{className:"chat__left"},a?o.a.createElement(z,null):o.a.createElement("div",{ref:g,className:"chat__list"},v.map((function(e,t){return o.a.createElement("div",{key:t,className:"chat__item"},o.a.createElement("strong",null,e.name),": ",e.text)}))),o.a.createElement("div",{className:"chat__control"},o.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t={id:c,name:E.name,avatarUrl:E.avatarUrl};!function(e,t){var a={name:r.name,text:e,avatarUrl:r.avatarUrl},n=Date.now();u(t,r,a,n).then((function(e){b.emit("sendMessage",{toId:c,fromId:r.id,companion:t,date:n,message:a})})).catch((function(e){}))}(f,t),p("")},className:"chat-control"},o.a.createElement("div",{className:"chat-control__left"},o.a.createElement("input",{onChange:function(e){return p(e.target.value)},type:"text",className:"form-control",value:f})),o.a.createElement("div",{className:"chat-control__right"},o.a.createElement("button",{className:"btn btn-success"},"Send"))))),o.a.createElement("div",{className:"chat__right"},o.a.createElement("div",{className:"chat__companion"},E.name||!a||o.a.createElement(z,null)))))}))),ee=(a(126),I(Object(s.b)((function(e){return{user:e.user,messages:e.messages}}),(function(e,t){var a=t.apiService;return Object(J.b)({actionFetchMessages:W(a),updateMessagesList:K},e)}))(Object(p.g)((function(e){var t=e.user,a=e.actionFetchMessages,r=e.queryChatId,c=!1;r&&(c=!0);var i=Object(n.useState)(c),l=Object(O.a)(i,2),u=l[0],m=l[1],d=Object(s.c)((function(e){return e.chat.loading})),f=Object(s.c)((function(e){return e.messages.loading})),p=Object(s.c)((function(e){return e.messages.messages}));Object(n.useEffect)((function(){a(t.id)}),[]);var v=u?o.a.createElement(Y,{backToMessages:function(){e.history.push("./"),m(!1)},companionId:r,chatLoading:d}):o.a.createElement(G,{openChat:function(t){return m({show:!0,receiverId:a=t}),void e.history.push("?chat=".concat(a));var a},messagesList:p});return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"messages"},f?o.a.createElement(z,null):o.a.createElement("div",{className:"messages__left"},v)))}))))),te=function(e){var t=Object(s.c)((function(e){return e.user.id})),a=H.a.parse(e.location.search).chat;return a&&a.toString()===t.toString()?o.a.createElement(p.a,{to:"/me"}):o.a.createElement(ee,{queryChatId:a})},ae=I(Object(s.b)((function(e){return{}}),(function(e){return Object(J.b)({actionUpdateUserData:E},e)}))((function(e){var t=e.userName,a=e.profileCounters,r=e.isOwner,c=e.avatarUrl,s=e.backgroundUrl,i=e.apiService,l=e.actionUpdateUserData,u=a.postsCount,m=void 0===u?0:u,d=a.imagesCount,f=void 0===d?0:d,p=a.followingCount,v=void 0===p?0:p,E=a.followersCount,g=void 0===E?0:E,h=Object(n.useContext)(q).publicPath,_=Object(n.useRef)(null),b=Object(n.useRef)(null),N=Object(n.useState)(!1),C=Object(O.a)(N,2),y=C[0],S=C[1],j=Object(n.useState)(null),k=Object(O.a)(j,2),w=k[0],U=k[1],T=Object(n.useState)(null),I=Object(O.a)(T,2),A=I[0],P=I[1],R=x()({"avatar-form":!0,active:y}),D=function(){S(!1),_.current.value=null},F=function(){P(""),b.current.value=null},L=x()({"profile-main":!0,"upload-bg":!!A});return o.a.createElement("div",{className:L},o.a.createElement("div",{className:"profile-main__update-bg"},o.a.createElement("div",{className:"update-bg"},o.a.createElement("input",{onChange:function(e){var t=e.target.files[0];if(t){var a=new FileReader;a.readAsDataURL(t),a.onloadend=function(){var e=a.result;P(e)}}else F()},ref:b,type:"file"}),A?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{onClick:function(e){e.preventDefault();var t=new FormData;t.append("background",b.current.files[0]),i.uploadBackground(t).then((function(e){F(),l({backgroundUrl:e.body.backgroundUrl})})).catch((function(e){}))},className:"btn update-bg__action"},"Update"),o.a.createElement("div",{onClick:F,className:"btn btn-danger update-bg__action"},"Cancel")):o.a.createElement("div",{onClick:function(){b.current.click()},className:"btn update-bg__action"},"Upload"))),o.a.createElement("div",{className:"profile-main__background"},o.a.createElement("div",{className:"profile-main__background-current",style:{backgroundImage:"url(".concat(h).concat(s,")")}}),o.a.createElement("div",{className:"profile-main__background-new",style:{backgroundImage:"url(".concat(A,")")}})),o.a.createElement("div",{className:"profile-main__info"},o.a.createElement("div",{className:"profile-info"},o.a.createElement("div",{className:"profile-info__top"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"profile-info__avatar"},o.a.createElement("div",{className:"profile-info__avatar-image",style:{backgroundImage:"url(".concat(h).concat(c,")")}},r?o.a.createElement("div",{className:"profile-info__form"},o.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=new FormData;t.append("avatar",_.current.files[0]),i.uploadAvatar(t).then((function(e){D(),l({avatarUrl:e.body.avatarUrl})})).catch((function(e){}))},className:R},o.a.createElement("label",{className:"avatar-form__label"},"Upload a new photo",o.a.createElement("input",{ref:_,onChange:function(e){var t=e.target.files[0];if(t){S(!0);var a=new FileReader;a.readAsDataURL(t),a.onloadend=function(){var e=a.result;U(e)}}else S(!1)},type:"file"})),o.a.createElement("div",{className:"avatar-form__content"},o.a.createElement("div",{className:"avatar-form__preview",style:{backgroundImage:"url(".concat(w,")")}}),o.a.createElement("div",{className:"avatar-form__actions"},o.a.createElement("div",{className:"avatar-form__apply"},o.a.createElement("button",{type:"submit",className:"btn"},"Apply")),o.a.createElement("div",{className:"avatar-form__cancel"},o.a.createElement("div",{onClick:D,className:"btn btn-danger"},"Cancel")))))):null)),o.a.createElement("div",{className:"profile-info__list"},o.a.createElement("div",{className:"profile-info__item"},o.a.createElement("div",{className:"profile-info__value"},g),o.a.createElement("div",{className:"profile-info__key"},"Followers")),o.a.createElement("div",{className:"profile-info__item"},o.a.createElement("div",{className:"profile-info__value"},v),o.a.createElement("div",{className:"profile-info__key"},"Following")),o.a.createElement("div",{className:"profile-info__item"},o.a.createElement("div",{className:"profile-info__value"},f),o.a.createElement("div",{className:"profile-info__key"},"Photos")),o.a.createElement("div",{className:"profile-info__item"},o.a.createElement("div",{className:"profile-info__value"},m),o.a.createElement("div",{className:"profile-info__key"},"Posts"))))),o.a.createElement("div",{className:"profile-info__bottom"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"profile-main__name"},t))))))}))),ne=a(10),oe=(a(127),I(Object(s.b)((function(e){return{}}),(function(e){return Object(J.b)({actionUpdateUserData:E},e)}))((function(e){var t=e._cardId,a=e._id,r=e.name,c=e.followersCount,s=e.followingCount,l=e.postsCount,u=e.avatarUrl,m=e.isFollowing,d=e.apiService,f=e.actionUpdateUserData,p=e.updateUser,v=Object(n.useContext)(q).publicPath;return o.a.createElement("div",{className:"user-card"},o.a.createElement("div",{className:"user-card__body"},o.a.createElement("div",{className:"user-card__head"},o.a.createElement("div",{className:"user-card__image",style:{backgroundImage:"url(".concat(v).concat(u,")")}})),o.a.createElement("div",{className:"user-card__name"},r)),o.a.createElement("div",{className:"user-card__actions"},a!==t?o.a.createElement("div",{onClick:function(){return e=t,void d.follow(a,e,m).then((function(t){if(t.body.ok){var a=t.body,n=a.isFollowing,o=a.client,r=a.user,c=r.followingCount,s=r.followersCount;p(e,{isFollowing:n,followingCount:c,followersCount:s}),f({followingCount:o.followingCount,followersCount:o.followersCount}),b.emit("follow",{toId:e,isFollowing:n})}})).catch((function(e){console.log(e)}));var e},className:"user-card__action link-yellow"},m?"Unfollow":"Follow"):null,o.a.createElement(i.c,{className:"user-card__action link-yellow",to:"/user/".concat(t)},"Page"),a!==t?o.a.createElement(i.c,{className:"user-card__action link-yellow",to:"/messages/?chat=".concat(t)},"Message"):null),o.a.createElement("div",{className:"user-card__info"},o.a.createElement("div",{className:"user-card__info-item"},o.a.createElement("div",{className:"user-card__info-key"},l),o.a.createElement("div",{className:"user-card__info-value"},"Posts")),o.a.createElement("div",{className:"user-card__info-item"},o.a.createElement("div",{className:"user-card__info-key"},c),o.a.createElement("div",{className:"user-card__info-value"},"Followers")),o.a.createElement("div",{className:"user-card__info-item"},o.a.createElement("div",{className:"user-card__info-key"},s),o.a.createElement("div",{className:"user-card__info-value"},"Following"))))})))),re=(a(128),I(Object(s.b)()((function(e){var t=e.fetchFunc,a=Object(s.c)((function(e){return e.user})),r=a.id,c=Object(n.useState)([]),i=Object(O.a)(c,2),u=i[0],m=i[1],d=Object(n.useState)(!0),f=Object(O.a)(d,2),p=f[0],v=f[1],E=function(e,t){m((function(a){var n=a.findIndex((function(t){return t._id===e})),o=Object(l.a)({},a[n],{},t);return[].concat(Object(ne.a)(a.slice(0,n)),[o],Object(ne.a)(a.slice(n+1)))}))};return Object(n.useEffect)((function(){v(!0),t(a.id).then((function(e){m(e.body.users),v(!1)})).catch((function(e){}))}),[t]),o.a.createElement("div",{className:"users"},p?o.a.createElement(z,null):o.a.createElement("div",{className:"users__list"},u.map((function(e){return o.a.createElement("div",{key:e._id,className:"users__item"},o.a.createElement(oe,{name:e.name,followersCount:e.followersCount,followingCount:e.followingCount,postsCount:e.postsCount,avatarUrl:e.avatarUrl,_id:r,_cardId:e._id,isFollowing:e.isFollowing,updateUser:E}))}))))})))),ce=I(Object(s.b)()((function(e){var t=e.apiService,a=Object(s.c)((function(e){return e.user})),r=a.followersCount,c=a.followingCount,i=a.imagesCount,l=a.postsCount,u=a.avatarUrl,m=a.backgroundUrl,d=a.name,f=(a.id,{followersCount:r,followingCount:c,imagesCount:i,postsCount:l}),p=Object(n.useCallback)((function(){return t.fetchFollowers.apply(t,arguments)}),[]);return o.a.createElement("div",{className:"profile"},o.a.createElement("div",{className:"profile__top"},o.a.createElement(ae,{profileCounters:f,avatarUrl:u,backgroundUrl:m,userName:d,isOwner:!0})),o.a.createElement("div",{className:"profile__bottom"},o.a.createElement("div",{className:"container"},o.a.createElement(re,{fetchFunc:p}))))}))),se=I(Object(s.b)()((function(e){var t=e.apiService,a=Object(s.c)((function(e){return e.user})),r=a.followersCount,c=a.followingCount,i=a.imagesCount,l=a.postsCount,u=a.avatarUrl,m=a.backgroundUrl,d=a.name,f={followersCount:r,followingCount:c,imagesCount:i,postsCount:l},p=Object(n.useCallback)((function(){return t.fetchFollowing.apply(t,arguments)}),[]);return o.a.createElement("div",{className:"profile"},o.a.createElement("div",{className:"profile__top"},o.a.createElement(ae,{profileCounters:f,avatarUrl:u,backgroundUrl:m,userName:d,isOwner:!0})),o.a.createElement("div",{className:"profile__bottom"},o.a.createElement("div",{className:"container"},o.a.createElement(re,{fetchFunc:p}))))}))),ie=function(e){var t=e.apiService,a=e.user,r=e.wallId,c=Object(n.useState)(""),s=Object(O.a)(c,2),i=s[0],l=s[1],u=Object(n.useState)(null),m=Object(O.a)(u,2),d=m[0],f=m[1],p=Object(n.useRef)(null),v=Object(n.useRef)(null),E=Object(n.useRef)(null),g=Object(n.useRef)(null),h=x()({btn:!0,"btn-danger":d});return o.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n=p.current.files[0];if(i.length>0||n){var o=new FormData;o.append("text",i),o.append("id",a.id),o.append("wallId",r),o.append("image",n),t.createPost(o).then((function(e){l(""),f(null),E.current.blur(),p.current.value=null,b.emit("createPost",{post:e.body.post,toId:r}),r.toString()!==a.id.toString()&&b.emit("sendPostData",{post:{imageUrl:e.body.post.imageUrl},toId:r})})).catch((function(e){}))}},className:"post-create"},o.a.createElement("input",{onChange:function(e){var t=e.target.files[0];if(t){var a=new FileReader;a.readAsDataURL(t),v.current.blur(),a.onloadend=function(){var e=a.result;f(e)}}else f(null)},ref:p,className:"hidden",type:"file"}),o.a.createElement("div",{className:"post-create__icon"},o.a.createElement("div",{className:"post-icon"},o.a.createElement("i",{className:"fa fa-comments-o","aria-hidden":"true"}))),o.a.createElement("div",{className:"post-create__wrap"},d?o.a.createElement("div",{className:"post-create__image"},o.a.createElement("img",{ref:g,src:d,alt:""})):null,o.a.createElement("div",{className:"post-create__input"},o.a.createElement("textarea",{onChange:function(e){l(e.target.value)},placeholder:"Write a new post...",className:"textarea-theme",value:i,id:"",cols:"30",rows:"10"})),o.a.createElement("div",{className:"post-create__actions"},o.a.createElement("div",{className:"post-create__action"},o.a.createElement("div",{ref:v,onClick:function(e){d?(f(null),v.current.blur()):p.current.click()},className:h},o.a.createElement("i",{className:"fa fa-picture-o","aria-hidden":"true"}))),o.a.createElement("div",{className:"post-create__action"},o.a.createElement("button",{ref:E,type:"submit",className:"btn"},"Post")))))},le=function(e){var t=e.posts,a=e.isOwner,r=void 0!==a&&a,c=e.user,s=e.apiService,i=(e.removePostById,e.wallId),l=e.toggleComments,u=(e.updatePostLikes,e.updatePostComments,e.updateCommentLikes,Object(n.useContext)(q).publicPath),m=function(e){return o.a.createElement("div",{className:"post-info"},o.a.createElement("div",{className:"post-info__comments"},o.a.createElement("div",{onClick:function(){return l(e._id)},className:"post-comments-button"},o.a.createElement("i",{className:"fa fa-comment-o","aria-hidden":"true"})," ",e.comments.length," Comments")),o.a.createElement("div",{className:"post-info__likes"},o.a.createElement("div",{onClick:function(){return t=e._id,a=e.isLiked,void s.likePost(c.id,t,a).then((function(e){if(e.body.ok){var t=e.body.post;b.emit("likePost",{post:t,userId:c.id,toId:i})}})).catch((function(e){}));var t,a},className:"post-likes-button"},e.isLiked?o.a.createElement("i",{style:{color:"red"},className:"fa fa-heart","aria-hidden":"true"}):o.a.createElement("i",{className:"fa fa-heart-o","aria-hidden":"true"})," ",e.likesCount," Likes")))},d=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return o.a.createElement("div",{className:"profile-post__image"},o.a.createElement("img",{src:"".concat(u).concat(e.imageUrl),alt:""}),t?m(e):null)},f=function(e,t){return o.a.createElement("div",{className:"comment"},o.a.createElement("div",{className:"comment__avatar",style:{backgroundImage:"url(".concat(u).concat(e.user.avatarUrl,")")}}),o.a.createElement("div",{className:"comment__content"},o.a.createElement("div",{className:"comment__head"},o.a.createElement("div",{className:"comment__name"},o.a.createElement("strong",null,e.user.name)),o.a.createElement("div",{className:"comment__date"},e.time)),o.a.createElement("div",{className:"comment__body"},o.a.createElement("div",{className:"comment__text"},e.text),o.a.createElement("div",{className:"comment__likes"},o.a.createElement("div",{onClick:function(){return a=e._id,n=e.isLiked,o=t._id,void s.likeComment(c.id,a,n).then((function(e){if(e.body.ok){var t=e.body.comment;b.emit("likeComment",{comment:t,userId:c.id,toId:i,postId:o})}})).catch((function(e){console.log(e.message)}));var a,n,o},className:"comment-like"},e.isLiked?o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{style:{color:"red"},className:"fa fa-heart","aria-hidden":"true"})):o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fa fa-heart-o","aria-hidden":"true"})),"\xa0",e.likesCount>0?e.likesCount:null)))))},p=function(e,a){var n=null;return n=a?d(e):o.a.createElement(o.a.Fragment,null,e.imageUrl?d(e,!1):null,o.a.createElement("div",{className:"profile-post__body"},o.a.createElement("div",{className:"profile-post__content"},e.text)),o.a.createElement("div",{className:"profile-post__info"},m(e))),o.a.createElement(o.a.Fragment,null,n,t.itemsUI[e._id].commentsOpened?o.a.createElement("div",{className:"profile-post__comments"},o.a.createElement("div",{className:"post-comment"},e.comments.length?o.a.createElement("div",{className:"post-comment__list"},e.comments.map((function(t){return o.a.createElement("div",{key:t._id,className:"post-comment__item"},f(t,e))}))):null,o.a.createElement("div",{className:"post-comment__create"},o.a.createElement("form",{onSubmit:function(t){return function(e,t){e.preventDefault();var a=e.target.elements[0].value;a&&(s.createComment(c.id,t,a).then((function(e){var a=e.body.comments;b.emit("createComment",{comments:a,postId:t,toId:i})})).catch((function(e){})),e.target.reset())}(t,e._id)},className:"comment-create"},o.a.createElement("div",{className:"comment-create__input"},o.a.createElement("textarea",{className:"textarea-theme",cols:"30",rows:"10"})),o.a.createElement("div",{className:"comment-create__actions"},o.a.createElement("div",{className:"comment-create__action"},o.a.createElement("button",{className:"btn"},"Comment"))))))):null)};return console.log("render wall list"),o.a.createElement("div",{className:"profile-wall__list"},t.items.map((function(e){var t=e.imageUrl&&!e.text,a=t?"a photo":"an article";return o.a.createElement("div",{key:e._id,className:"profile-wall__item"},o.a.createElement("div",{className:"profile-post"},o.a.createElement("div",{className:"profile-post__icon"},t?o.a.createElement("div",{className:"post-icon post-icon_green"},o.a.createElement("i",{className:"fa fa-picture-o","aria-hidden":"true"})):o.a.createElement("div",{className:"post-icon post-icon_tomato"},o.a.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"}))),r?o.a.createElement("div",{className:"profile-post__remove"},o.a.createElement("div",{onClick:function(){return t=e._id,void s.removePost(t).then((function(e){b.emit("removePost",{postId:t,toId:i})})).catch((function(e){}));var t},className:"post-icon post-icon_remove"},o.a.createElement("i",{className:"fa fa-times","aria-hidden":"true"}))):null,o.a.createElement("div",{className:"profile-post__head"},o.a.createElement("div",{className:"profile-post__head-left"},o.a.createElement("span",{className:"profile-post__name"},e.user.name)," posted ",a),o.a.createElement("div",{className:"profile-post__head-right"},e.time)),p(e,t)))})))},ue=(a(129),A(I(Object(s.b)((function(e){return{user:e.user}}),(function(e){return Object(J.b)({actionUpdateUserData:E},e)}))((function(e){var t=e.apiService,a=e.actionUpdateUserData,r=e.user,c=e.isUserPage,s=e.userPageId,i=e.profileCounters,u=e.updateProfileCounters,m=e.avatarUrl,d=e.backgroundUrl,f=e.setAvatarUrl,p=!c,v=c?s:r.id,E=Object(n.useState)({}),g=Object(O.a)(E,2),h=g[0],_=g[1],N=Object(n.useState)(!0),C=Object(O.a)(N,2),y=C[0],S=C[1],j=Object(n.useState)(null),w=Object(O.a)(j,2),U=w[0],T=w[1],I=Object(n.useState)({items:[],itemsUI:{}}),A=Object(O.a)(I,2),P=A[0],R=A[1],D=function(e){var t=P.itemsUI;return e.reduce((function(e,a){var n=t[a._id]&&t[a._id].commentsOpened||!1;return Object(l.a)({},e,Object(k.a)({},a._id,{commentsOpened:n}))}),{})},x=function(e){var t=D(e);R((function(a){return{items:e,itemsUI:t}}))},F=function(e){R((function(t){var a=t.items,n=a.findIndex((function(t){return t._id===e})),o=a[n],r=a.filter((function(t){return t._id!==e}));return T(o),{items:r,itemsUI:D(r)}}))};Object(n.useEffect)((function(){return b.on("createPost",(function(e){var t=e.post;H(t)})),b.on("removePost",(function(e){var t=e.postId;F(t)})),b.on("likePost",(function(e){var t=e.post,a=e.userId;q(t,a)})),b.on("createComment",(function(e){var t=e.comments,a=e.postId;M(a,t)})),b.on("likeComment",(function(e){var t=e.comment,a=e.userId,n=e.postId;G(n,t,a)})),function(){b.off("createPost"),b.off("removePost"),b.off("likePost"),b.off("createComment"),b.off("likeComment")}}),[]),Object(n.useEffect)((function(){if(U){var e=i.postsCount-1,t=U.imageUrl?i.imagesCount-1:i.imagesCount;u({postsCount:e,imagesCount:t})}}),[U]),Object(n.useEffect)((function(){var e=c?s:r.id;return b.emit("connectToWallId",{wallId:e}),function(){b.emit("disconnectToWallId",{wallId:e})}}),[]),Object(n.useEffect)((function(){c?(S(!0),t.getUserInfo(s,r.id).then((function(e){var t=e.body.data;f(t.avatarUrl),u({followersCount:t.followersCount,followingCount:t.followingCount,postsCount:t.postsCount,imagesCount:t.imagesCount}),_({avatarUrl:t.avatarUrl,userName:t.name,userId:t.id,isFollowing:t.isFollowing}),x(t.posts),S(!1)})).catch((function(e){}))):(_(Object(l.a)({},h,{avatarUrl:r.avatarUrl,userName:r.name,userId:r.id})),S(!0),t.fetchPosts(r.id).then((function(e){x(e.body.posts),S(!1)})).catch((function(e){S(!1)})))}),[]);var L=function(){t.follow(r.id,s,B).then((function(e){var t,n,o=e.body,r=o.isFollowing,c=o.client,i=o.user;t="isFollowing",n=r,_((function(e){return Object(l.a)({},e,Object(k.a)({},t,n))})),u({followingCount:i.followingCount,followersCount:i.followersCount}),a({followingCount:c.followingCount,followersCount:c.followersCount}),b.emit("follow",{toId:s,isFollowing:r})})).catch((function(e){}))},M=function(e,t){R((function(a){var n=a.items,o=n.findIndex((function(t){return t._id===e})),r=n[o],c=Object(l.a)({},r,{comments:t}),s=[].concat(Object(ne.a)(n.slice(0,o)),[c],Object(ne.a)(n.slice(o+1))),i=a.itemsUI,u=s.reduce((function(e,t){var a=i[t._id]&&i[t._id].commentsOpened||!1;return Object(l.a)({},e,Object(k.a)({},t._id,{commentsOpened:a}))}),{});return{items:s,itemsUI:u}}))},H=function(e){var t=e.imageUrl?1:0;u((function(e){return{postsCount:e.postsCount+1,imagesCount:e.imagesCount+t}})),function(e){R((function(t){var a=[e].concat(Object(ne.a)(t.items));return{items:a,itemsUI:D(a)}}))}(e)},q=function(e,t){R((function(a){var n=a.items,o=e._id,c=e.likesCount,s=e.isLiked,i=n.findIndex((function(e){return e._id===o})),u=n[i],m=Object(l.a)({},u,{likesCount:c,isLiked:r.id.toString()===t.toString()?s:u.isLiked}),d=[].concat(Object(ne.a)(n.slice(0,i)),[m],Object(ne.a)(n.slice(i+1)));return{items:d,itemsUI:D(d)}}))},G=function(e,t,a){R((function(n){var o=n.items,c=(t._id,t.isLiked),s=t.likesCount,i=o.findIndex((function(t){return t._id===e})),u=o[i],m=u.comments.findIndex((function(e){return e._id===t._id})),d=u.comments[m],f=Object(l.a)({},d,{likesCount:s,isLiked:r.id.toString()===a.toString()?c:d.isLiked}),p=Object(l.a)({},u,{comments:[].concat(Object(ne.a)(u.comments.slice(0,m)),[f],Object(ne.a)(u.comments.slice(m+1)))}),v=[].concat(Object(ne.a)(o.slice(0,i)),[p],Object(ne.a)(o.slice(i+1))),E=n.itemsUI,g=v.reduce((function(e,t){var a=E[t._id]&&E[t._id].commentsOpened||!1;return Object(l.a)({},e,Object(k.a)({},t._id,{commentsOpened:a}))}),{});return{items:v,itemsUI:g}}))},J=h.userName,W=h.userId,B=h.isFollowing;return o.a.createElement("div",{className:"profile"},o.a.createElement("div",{className:"profile__top"},o.a.createElement(ae,{profileCounters:i,isOwner:p,userName:J,avatarUrl:m,backgroundUrl:d})),o.a.createElement("div",{className:"profile__bottom"},o.a.createElement("div",{className:"container"},p?null:o.a.createElement("div",{className:"profile__actions"},o.a.createElement("div",{className:"profile__follow"},B?o.a.createElement("div",{onClick:L,className:"btn btn-danger"},"Unfollow"):o.a.createElement("div",{onClick:L,className:"btn"},"Follow"))),o.a.createElement("div",{className:"profile__wall"},o.a.createElement("div",{className:"profile__wall-bar"}),o.a.createElement("div",{className:"profile__wall-left"},o.a.createElement("div",{className:"profile-wall"},o.a.createElement("div",{className:"profile-wall__top"},o.a.createElement("div",{className:"profile-wall__create"},o.a.createElement(ie,{apiService:t,user:e.user,wallId:W,addPost:H,updatePosts:x})),y?o.a.createElement(z,null):null),o.a.createElement(le,{isOwner:p,posts:P,apiService:t,user:r,wallId:v,removePostById:F,updatePostLikes:q,updatePostComments:M,toggleComments:function(e){var t,a=P.itemsUI,n=a[e].commentsOpened,o=Object(l.a)({},a,Object(k.a)({},e,{commentsOpened:!n}));t=o,R((function(e){return{items:P.items,itemsUI:t}}))},updateCommentLikes:G})))))))}))))),me=function(e){var t=e.computedMatch.params.id,a=Object(n.useState)(null),r=Object(O.a)(a,2),c=r[0],s=r[1],i=Object(n.useState)({}),u=Object(O.a)(i,2),m=u[0],d=u[1];return o.a.createElement(ue,Object.assign({setAvatarUrl:s,avatarUrl:c,userPageId:t,profileCounters:m,updateProfileCounters:function(e){d("function"===typeof e?function(t){var a=e(t);return Object(l.a)({},t,{},a)}:function(t){return Object(l.a)({},t,{},e)})},isUserPage:!0},e))},de=Object(s.b)((function(e){return{}}),(function(e){return Object(J.b)({actionUpdateUserCounters:g},e)}))((function(e){var t=e.actionUpdateUserCounters,a=Object(s.c)((function(e){return e.user})),n=a.avatarUrl,r=a.backgroundUrl,c={followersCount:a.followersCount,followingCount:a.followingCount,imagesCount:a.imagesCount,postsCount:a.postsCount};return o.a.createElement(ue,Object.assign({avatarUrl:n,backgroundUrl:r,profileCounters:c,updateProfileCounters:function(e){t(e)}},e))})),fe=(a(130),I(Object(s.b)()((function(e){var t=e.apiService,a=Object(s.c)((function(e){return e.user})),r=a.followersCount,c=a.followingCount,i=a.imagesCount,l=a.postsCount,u=a.avatarUrl,m=a.backgroundUrl,d=a.name,f=Object(n.useState)(""),p=Object(O.a)(f,2),v=p[0],E=p[1],g=Object(n.useState)(""),h=Object(O.a)(g,2),_=h[0],b=h[1],N=Object(n.useCallback)((function(){return t.fetchUsers(v)}),[v]),C={followersCount:r,followingCount:c,imagesCount:i,postsCount:l};return o.a.createElement("div",{className:"profile"},o.a.createElement("div",{className:"profile__top"},o.a.createElement(ae,{profileCounters:C,avatarUrl:u,backgroundUrl:m,userName:d,isOwner:!0})),o.a.createElement("div",{className:"profile__bottom"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"search"},o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),E(_)},className:"search__form"},o.a.createElement("div",{className:"search__text"},o.a.createElement("input",{value:_,onChange:function(e){b(e.target.value)},placeholder:"Type a name",type:"text"})),o.a.createElement("div",{className:"search__find"},o.a.createElement("button",{type:"submit",className:"btn"},"Find"))),o.a.createElement("div",{className:"search__result"},o.a.createElement(re,{fetchFunc:N}))))))})))),pe=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){var n=this.props.apiService,o=this.props.user.token;e.user.token!==o&&n.setToken(o)}},{key:"getUser",value:function(){return this.props.user}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.apiService,n=t.updateMessageInList,o=t.addChatMessage,r=(t.getUserData,t.actionUpdateUserCounters);b.on("getMessage",(function(t){console.log("get data",t);var r=e.getUser(),c=e.props.chat,s=c.inChat,i=c.chatId,u=t.fromId.toString()===r.id.toString(),m=Object(l.a)({},t.message);u&&(m.name=t.companion.name,m.avatarUrl=t.companion.avatarUrl,n({id:t.toId,updated:!1,message:m,sort:!0})),!s||i.toString()!==t.toId.toString()&&i.toString()!==t.fromId.toString()?u||(window.M.toast({html:"<b>".concat(t.message.name,"</b>: ").concat(t.message.text)}),n({id:t.fromId,updated:!0,message:m,sort:!0})):(o(t.message),u||(a.updateChatTime(r.id,t.fromId,t.date),n({id:t.fromId,updated:!1,message:m,sort:!0})))})),b.on("follow",(function(t){var a=t.isFollowing?1:-1;r({followersCount:e.getUser().followersCount+a})})),b.on("sendPostData",(function(t){var a=t.post.imageUrl?1:0;r({postsCount:e.getUser().postsCount+1,imagesCount:e.getUser().imagesCount+a})}))}},{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(N,null),o.a.createElement("div",{className:"content pt-3"},o.a.createElement(p.d,null,o.a.createElement(p.b,{path:"/",exact:!0,component:C}),o.a.createElement(j,{exact:!0,path:"/cart",component:v}),o.a.createElement(p.b,{path:"/store",component:y}),o.a.createElement(j,{exact:!0,path:"/me",component:de}),o.a.createElement(j,{exact:!0,path:"/followers",component:ce}),o.a.createElement(j,{exact:!0,path:"/following",component:se}),o.a.createElement(j,{exact:!0,path:"/messages/",component:te}),o.a.createElement(j,{exact:!0,path:"/search",component:fe}),o.a.createElement(p.b,{path:"/login",component:R}),o.a.createElement(p.b,{path:"/register",component:L}),o.a.createElement(p.b,{path:"/test",render:function(){return o.a.createElement("h2",null,"Test page")}}),o.a.createElement(j,{path:"/user/:id",component:me}),o.a.createElement(p.a,{to:"/"}))))}}]),a}(o.a.Component),ve=I(Object(s.b)((function(e){return{getNewMessage:e.messages.getNewMessage,user:e.user,chat:e.chat}}),(function(e){return Object(l.a)({getUserData:function(t,a){return e(h(t,a)())}},Object(J.b)({updateMessageInList:B,sortMessagesList:V,addChatMessage:$,actionUpdateUserCounters:g},e))}))(pe));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ee=a(73),ge=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).status=401,e}return a}(Object(Ee.a)(Error)),he=function(){function e(){var t=this;Object(u.a)(this,e),this.URL="/api/",this.token=null,this.getUserData=function(){return t.getRequest("userData",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t.getToken()}})},this.sendMessage=function(e,a,n,o,r){return t.getRequest("sendMessage",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t.getToken()},body:JSON.stringify({id:e,senderId:a,message:n,companion:o,date:r})})},this.getChatMessages=function(e,a){return t.getRequest("chatMessages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,receiverId:a})})},this.getListMessages=function(e){return t.getRequest("listMessages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})}}return Object(m.a)(e,[{key:"getRequest",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,o){fetch("".concat(t.URL).concat(e),a).then((function(e){return e.json().then((function(t){return{status:e.status,body:t}}))})).then((function(e){401===e.status&&o(new ge),n(e)})).catch((function(e){o(e)}))}))}},{key:"login",value:function(e){return this.getRequest("login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"register",value:function(e){return this.getRequest("register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"uploadAvatar",value:function(e){return this.getRequest("uploadAvatar",{method:"POST",headers:{Authorization:this.getToken()},body:e})}},{key:"uploadBackground",value:function(e){return this.getRequest("uploadBackground",{method:"POST",headers:{Authorization:this.getToken()},body:e})}},{key:"fetchPosts",value:function(e){return this.getRequest("posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.getToken()},body:JSON.stringify({id:e})})}},{key:"createPost",value:function(e){return this.getRequest("createPost",{method:"POST",headers:{Authorization:this.getToken()},body:e})}},{key:"removePost",value:function(e){return this.getRequest("posts",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:this.getToken()},body:JSON.stringify({id:e})})}},{key:"likePost",value:function(e,t,a){var n=this.getToken();return this.getRequest("postLike",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify({userId:e,postId:t,like:a})})}},{key:"createComment",value:function(e,t,a){return this.getRequest("createComment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.getToken()},body:JSON.stringify({userId:e,postId:t,text:a})})}},{key:"likeComment",value:function(e,t,a){return this.getRequest("likeComment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.getToken()},body:JSON.stringify({userId:e,commentId:t,like:a})})}},{key:"updateChatTime",value:function(e,t,a){return this.getRequest("chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,receiverId:t,date:a})})}},{key:"getUserInfo",value:function(e,t){var a=this.getToken();return this.getRequest("userInfo",{method:"POST",headers:{"Content-Type":"application/json",Authorization:a},body:JSON.stringify({id:e,clientId:t})})}},{key:"follow",value:function(e,t,a){return console.log(e,t,a),this.getRequest("follow",{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.getToken()},body:JSON.stringify({followerId:e,followingId:t,isFollowing:a})})}},{key:"fetchFollowers",value:function(e){return this.getRequest("followers",{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.getToken()},body:JSON.stringify({userId:e})})}},{key:"fetchFollowing",value:function(e){return this.getRequest("following",{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.getToken()},body:JSON.stringify({userId:e})})}},{key:"fetchUsers",value:function(e){return this.getRequest("users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.getToken()},body:JSON.stringify({match:e})})}},{key:"setToken",value:function(e){this.token=e}},{key:"getToken",value:function(){return this.token}}]),e}(),_e=(a(131),{name:null,auth:!1,token:null,id:null,avatarUrl:null,followingCount:0,followersCount:0}),be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USER_SUCCESS":case"AUTH_CHECK_SUCCESS":case"USER_AUTHORIZE":case"USER_DATA_UPDATE":return Object(l.a)({},e,{},t.payload);case"USER_COUNTERS_UPDATE":var a,n="function"===typeof t.payload&&t.payload;return a=n?n(e):t.payload,Object(l.a)({},e,{},a);case"USER_UNAUTHORIZE":return Object(l.a)({},_e);default:return e}},Ne={loading:!0,messages:[]},Ce=function(e,t,a,n,o){return{name:e,text:t,id:a,avatarUrl:n,updated:o}},Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_MESSAGES":return{loading:!0,messages:[]};case"FETCH_MESSAGES_SUCCESS":return{loading:!1,messages:t.payload};case"FETCH_MESSAGES_FAILURE":return{loading:!1,messages:Object(ne.a)(e.messages)};case"MESSAGE_UPDATE":var a=t.payload,n=a.id,o=a.updated,r=a.message,c=a.sort,s=void 0===c||c,i=e.messages.findIndex((function(e){return e.id===n})),u=Object(ne.a)(e.messages);if(s){var m=r.name,d=r.text,f=r.avatarUrl;i>=0&&(m=u[i].name,u=u.filter((function(e){return e.id!==n}))),u.unshift(Ce(m,d,n,f,o))}else i>=0&&(u[i].updated=o);return Object(l.a)({},e,{messages:u});case"MESSAGES_LIST_UPDATE":return Object(l.a)({},e,{messages:t.payload});default:return e}},ye={messages:[],loading:!1,inChat:!1,chatId:null,companion:{}},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_CHAT":return Object(l.a)({},e,{loading:!0});case"FETCH_CHAT_SUCCESS":return Object(l.a)({},e,{messages:t.payload.messages,companion:Object(l.a)({},t.payload.companion),loading:!1});case"FETCH_CHAT_FAILURE":return Object(l.a)({},e,{loading:!1});case"CHAT_STATUS_UPDATE":var a=t.payload,n=a.inChat,o=void 0!==n&&n,r=a.chatId,c=void 0===r?null:r;return Object(l.a)({},e,{inChat:o,chatId:c});case"CHAT_MESSAGE_ADD":return Object(l.a)({},e,{messages:[].concat(Object(ne.a)(e.messages),[t.payload])});default:return e}},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"COUNTER_ADD":return e+1;default:return e}},ke=Object(J.c)({user:be,messages:Oe,chat:Se,counter:je}),we=a(71),Ue=a(72);a(22),a(39),new he;var Te=Object(Ue.a)(),Ie=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Ae=Object(J.e)(ke,Object(J.d)(Object(J.a)(we.a,Te,(function(){return function(e){return function(t){return console.log(t),e(t)}}})),Ie)),Pe=new he,Re=localStorage.getItem("userData");function De(){c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(s.a,{store:Ae},o.a.createElement(U,{value:Pe},o.a.createElement(q.Provider,{value:{publicPath:"/public/images/"}},o.a.createElement(i.a,null,o.a.createElement(ve,null)))))),document.getElementById("root"))}Pe.setToken(Re),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_SOCKET_PORT:"5000"}),Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_SOCKET_PORT:"5000"}).CLIENT_SOCKET_PORT),b.on("connect",(function(){Re?Ae.dispatch(h(Pe,Re)()).then((function(e){De();var t=Ae.getState().user.id;b.emit("connected",{id:t})})):De()})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},75:function(e,t,a){e.exports=a(133)},84:function(e,t,a){}},[[75,1,2]]]);
//# sourceMappingURL=main.2efe6bb4.chunk.js.map